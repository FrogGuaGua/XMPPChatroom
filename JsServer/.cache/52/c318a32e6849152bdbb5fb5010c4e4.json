{"id":"Lq6I","dependencies":[{"name":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\package.json","includedInParent":true,"mtime":1720867255394},{"name":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\package.json","includedInParent":true,"mtime":1720399443533},{"name":"./forge","loc":{"line":10,"column":20,"index":245},"parent":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\lib\\kem.js","resolved":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\lib\\forge.js"},{"name":"./util","loc":{"line":11,"column":8,"index":265},"parent":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\lib\\kem.js","resolved":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\lib\\util.js"},{"name":"./random","loc":{"line":12,"column":8,"index":284},"parent":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\lib\\kem.js","resolved":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\lib\\random.js"},{"name":"./jsbn","loc":{"line":13,"column":8,"index":305},"parent":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\lib\\kem.js","resolved":"C:\\Users\\948780232\\Desktop\\XMPP\\RindChatroom\\JsServer\\node_modules\\node-forge\\lib\\jsbn.js"}],"generated":{"js":"var e=require(\"./forge\");require(\"./util\"),require(\"./random\"),require(\"./jsbn\"),module.exports=e.kem=e.kem||{};var t=e.jsbn.BigInteger;function r(t,r,n,i){t.generate=function(t,u){for(var a=new e.util.ByteBuffer,o=Math.ceil(u/i)+n,g=new e.util.ByteBuffer,s=n;s<o;++s){g.putInt32(s),r.start(),r.update(t+g.getBytes());var c=r.digest();a.putBytes(c.getBytes(i))}return a.truncate(a.length()-u),a.getBytes()}}e.kem.rsa={},e.kem.rsa.create=function(r,n){var i=(n=n||{}).prng||e.random,u={encrypt:function(n,u){var a,o=Math.ceil(n.n.bitLength()/8);do{a=new t(e.util.bytesToHex(i.getBytesSync(o)),16).mod(n.n)}while(a.compareTo(t.ONE)<=0);var g=o-(a=e.util.hexToBytes(a.toString(16))).length;return g>0&&(a=e.util.fillString(String.fromCharCode(0),g)+a),{encapsulation:n.encrypt(a,\"NONE\"),key:r.generate(a,u)}},decrypt:function(e,t,n){var i=e.decrypt(t,\"NONE\");return r.generate(i,n)}};return u},e.kem.kdf1=function(e,t){r(this,e,0,t||e.digestLength)},e.kem.kdf2=function(e,t){r(this,e,1,t||e.digestLength)};"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/node-forge/lib/kem.js","original":{"line":10,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":10,"column":4},"generated":{"line":1,"column":4}},{"source":"node_modules/node-forge/lib/kem.js","name":"require","original":{"line":10,"column":12},"generated":{"line":1,"column":6}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":10,"column":20},"generated":{"line":1,"column":14}},{"source":"node_modules/node-forge/lib/kem.js","name":"require","original":{"line":11,"column":0},"generated":{"line":1,"column":25}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":11,"column":8},"generated":{"line":1,"column":33}},{"source":"node_modules/node-forge/lib/kem.js","name":"require","original":{"line":12,"column":0},"generated":{"line":1,"column":43}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":12,"column":8},"generated":{"line":1,"column":51}},{"source":"node_modules/node-forge/lib/kem.js","name":"require","original":{"line":13,"column":0},"generated":{"line":1,"column":63}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":13,"column":8},"generated":{"line":1,"column":71}},{"source":"node_modules/node-forge/lib/kem.js","name":"module","original":{"line":15,"column":0},"generated":{"line":1,"column":81}},{"source":"node_modules/node-forge/lib/kem.js","name":"exports","original":{"line":15,"column":7},"generated":{"line":1,"column":88}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":15,"column":17},"generated":{"line":1,"column":96}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":15,"column":23},"generated":{"line":1,"column":98}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":15,"column":29},"generated":{"line":1,"column":102}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":15,"column":35},"generated":{"line":1,"column":104}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":15,"column":42},"generated":{"line":1,"column":109}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":17,"column":0},"generated":{"line":1,"column":112}},{"source":"node_modules/node-forge/lib/kem.js","name":"BigInteger","original":{"line":17,"column":4},"generated":{"line":1,"column":116}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":17,"column":17},"generated":{"line":1,"column":118}},{"source":"node_modules/node-forge/lib/kem.js","name":"jsbn","original":{"line":17,"column":23},"generated":{"line":1,"column":120}},{"source":"node_modules/node-forge/lib/kem.js","name":"BigInteger","original":{"line":17,"column":28},"generated":{"line":1,"column":125}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":137,"column":0},"generated":{"line":1,"column":136}},{"source":"node_modules/node-forge/lib/kem.js","name":"_createKDF","original":{"line":137,"column":9},"generated":{"line":1,"column":145}},{"source":"node_modules/node-forge/lib/kem.js","name":"kdf","original":{"line":137,"column":20},"generated":{"line":1,"column":147}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":137,"column":25},"generated":{"line":1,"column":149}},{"source":"node_modules/node-forge/lib/kem.js","name":"counterStart","original":{"line":137,"column":29},"generated":{"line":1,"column":151}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":137,"column":43},"generated":{"line":1,"column":153}},{"source":"node_modules/node-forge/lib/kem.js","name":"kdf","original":{"line":146,"column":2},"generated":{"line":1,"column":156}},{"source":"node_modules/node-forge/lib/kem.js","name":"generate","original":{"line":146,"column":6},"generated":{"line":1,"column":158}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":146,"column":17},"generated":{"line":1,"column":167}},{"source":"node_modules/node-forge/lib/kem.js","name":"x","original":{"line":146,"column":26},"generated":{"line":1,"column":176}},{"source":"node_modules/node-forge/lib/kem.js","name":"length","original":{"line":146,"column":29},"generated":{"line":1,"column":178}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":153,"column":4},"generated":{"line":1,"column":181}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":147,"column":4},"generated":{"line":1,"column":185}},{"source":"node_modules/node-forge/lib/kem.js","name":"key","original":{"line":147,"column":8},"generated":{"line":1,"column":189}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":147,"column":14},"generated":{"line":1,"column":191}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":147,"column":18},"generated":{"line":1,"column":195}},{"source":"node_modules/node-forge/lib/kem.js","name":"util","original":{"line":147,"column":24},"generated":{"line":1,"column":197}},{"source":"node_modules/node-forge/lib/kem.js","name":"ByteBuffer","original":{"line":147,"column":29},"generated":{"line":1,"column":202}},{"source":"node_modules/node-forge/lib/kem.js","name":"k","original":{"line":150,"column":8},"generated":{"line":1,"column":213}},{"source":"node_modules/node-forge/lib/kem.js","name":"Math","original":{"line":150,"column":12},"generated":{"line":1,"column":215}},{"source":"node_modules/node-forge/lib/kem.js","name":"ceil","original":{"line":150,"column":17},"generated":{"line":1,"column":220}},{"source":"node_modules/node-forge/lib/kem.js","name":"length","original":{"line":150,"column":22},"generated":{"line":1,"column":225}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":150,"column":31},"generated":{"line":1,"column":227}},{"source":"node_modules/node-forge/lib/kem.js","name":"counterStart","original":{"line":150,"column":47},"generated":{"line":1,"column":230}},{"source":"node_modules/node-forge/lib/kem.js","name":"c","original":{"line":152,"column":8},"generated":{"line":1,"column":232}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":152,"column":12},"generated":{"line":1,"column":234}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":152,"column":16},"generated":{"line":1,"column":238}},{"source":"node_modules/node-forge/lib/kem.js","name":"util","original":{"line":152,"column":22},"generated":{"line":1,"column":240}},{"source":"node_modules/node-forge/lib/kem.js","name":"ByteBuffer","original":{"line":152,"column":27},"generated":{"line":1,"column":245}},{"source":"node_modules/node-forge/lib/kem.js","name":"i","original":{"line":153,"column":12},"generated":{"line":1,"column":256}},{"source":"node_modules/node-forge/lib/kem.js","name":"counterStart","original":{"line":153,"column":16},"generated":{"line":1,"column":258}},{"source":"node_modules/node-forge/lib/kem.js","name":"i","original":{"line":153,"column":30},"generated":{"line":1,"column":260}},{"source":"node_modules/node-forge/lib/kem.js","name":"k","original":{"line":153,"column":34},"generated":{"line":1,"column":262}},{"source":"node_modules/node-forge/lib/kem.js","name":"i","original":{"line":153,"column":39},"generated":{"line":1,"column":266}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":153,"column":42},"generated":{"line":1,"column":268}},{"source":"node_modules/node-forge/lib/kem.js","name":"c","original":{"line":155,"column":6},"generated":{"line":1,"column":269}},{"source":"node_modules/node-forge/lib/kem.js","name":"putInt32","original":{"line":155,"column":8},"generated":{"line":1,"column":271}},{"source":"node_modules/node-forge/lib/kem.js","name":"i","original":{"line":155,"column":17},"generated":{"line":1,"column":280}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":158,"column":6},"generated":{"line":1,"column":283}},{"source":"node_modules/node-forge/lib/kem.js","name":"start","original":{"line":158,"column":9},"generated":{"line":1,"column":285}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":159,"column":6},"generated":{"line":1,"column":293}},{"source":"node_modules/node-forge/lib/kem.js","name":"update","original":{"line":159,"column":9},"generated":{"line":1,"column":295}},{"source":"node_modules/node-forge/lib/kem.js","name":"x","original":{"line":159,"column":16},"generated":{"line":1,"column":302}},{"source":"node_modules/node-forge/lib/kem.js","name":"c","original":{"line":159,"column":20},"generated":{"line":1,"column":304}},{"source":"node_modules/node-forge/lib/kem.js","name":"getBytes","original":{"line":159,"column":22},"generated":{"line":1,"column":306}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":160,"column":6},"generated":{"line":1,"column":318}},{"source":"node_modules/node-forge/lib/kem.js","name":"hash","original":{"line":160,"column":10},"generated":{"line":1,"column":322}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":160,"column":17},"generated":{"line":1,"column":324}},{"source":"node_modules/node-forge/lib/kem.js","name":"digest","original":{"line":160,"column":20},"generated":{"line":1,"column":326}},{"source":"node_modules/node-forge/lib/kem.js","name":"key","original":{"line":161,"column":6},"generated":{"line":1,"column":335}},{"source":"node_modules/node-forge/lib/kem.js","name":"putBytes","original":{"line":161,"column":10},"generated":{"line":1,"column":337}},{"source":"node_modules/node-forge/lib/kem.js","name":"hash","original":{"line":161,"column":19},"generated":{"line":1,"column":346}},{"source":"node_modules/node-forge/lib/kem.js","name":"getBytes","original":{"line":161,"column":24},"generated":{"line":1,"column":348}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":161,"column":33},"generated":{"line":1,"column":357}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":166,"column":4},"generated":{"line":1,"column":361}},{"source":"node_modules/node-forge/lib/kem.js","name":"key","original":{"line":165,"column":4},"generated":{"line":1,"column":368}},{"source":"node_modules/node-forge/lib/kem.js","name":"truncate","original":{"line":165,"column":8},"generated":{"line":1,"column":370}},{"source":"node_modules/node-forge/lib/kem.js","name":"key","original":{"line":165,"column":17},"generated":{"line":1,"column":379}},{"source":"node_modules/node-forge/lib/kem.js","name":"length","original":{"line":165,"column":21},"generated":{"line":1,"column":381}},{"source":"node_modules/node-forge/lib/kem.js","name":"length","original":{"line":165,"column":32},"generated":{"line":1,"column":390}},{"source":"node_modules/node-forge/lib/kem.js","name":"key","original":{"line":166,"column":11},"generated":{"line":1,"column":393}},{"source":"node_modules/node-forge/lib/kem.js","name":"getBytes","original":{"line":166,"column":15},"generated":{"line":1,"column":395}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":22,"column":0},"generated":{"line":1,"column":407}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":22,"column":6},"generated":{"line":1,"column":409}},{"source":"node_modules/node-forge/lib/kem.js","name":"rsa","original":{"line":22,"column":10},"generated":{"line":1,"column":413}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":22,"column":16},"generated":{"line":1,"column":417}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":38,"column":0},"generated":{"line":1,"column":420}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":38,"column":6},"generated":{"line":1,"column":422}},{"source":"node_modules/node-forge/lib/kem.js","name":"rsa","original":{"line":38,"column":10},"generated":{"line":1,"column":426}},{"source":"node_modules/node-forge/lib/kem.js","name":"create","original":{"line":38,"column":14},"generated":{"line":1,"column":430}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":38,"column":23},"generated":{"line":1,"column":437}},{"source":"node_modules/node-forge/lib/kem.js","name":"kdf","original":{"line":38,"column":32},"generated":{"line":1,"column":446}},{"source":"node_modules/node-forge/lib/kem.js","name":"options","original":{"line":38,"column":37},"generated":{"line":1,"column":448}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":40,"column":2},"generated":{"line":1,"column":451}},{"source":"node_modules/node-forge/lib/kem.js","name":"prng","original":{"line":40,"column":6},"generated":{"line":1,"column":455}},{"source":"node_modules/node-forge/lib/kem.js","name":"options","original":{"line":39,"column":2},"generated":{"line":1,"column":458}},{"source":"node_modules/node-forge/lib/kem.js","name":"options","original":{"line":39,"column":12},"generated":{"line":1,"column":460}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":39,"column":23},"generated":{"line":1,"column":463}},{"source":"node_modules/node-forge/lib/kem.js","name":"prng","original":{"line":40,"column":21},"generated":{"line":1,"column":467}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":40,"column":29},"generated":{"line":1,"column":473}},{"source":"node_modules/node-forge/lib/kem.js","name":"random","original":{"line":40,"column":35},"generated":{"line":1,"column":475}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":42,"column":6},"generated":{"line":1,"column":482}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":42,"column":12},"generated":{"line":1,"column":484}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":55,"column":2},"generated":{"line":1,"column":485}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":55,"column":16},"generated":{"line":1,"column":493}},{"source":"node_modules/node-forge/lib/kem.js","name":"publicKey","original":{"line":55,"column":25},"generated":{"line":1,"column":502}},{"source":"node_modules/node-forge/lib/kem.js","name":"keyLength","original":{"line":55,"column":36},"generated":{"line":1,"column":504}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":57,"column":4},"generated":{"line":1,"column":507}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":58,"column":8},"generated":{"line":1,"column":511}},{"source":"node_modules/node-forge/lib/kem.js","name":"byteLength","original":{"line":57,"column":8},"generated":{"line":1,"column":513}},{"source":"node_modules/node-forge/lib/kem.js","name":"Math","original":{"line":57,"column":21},"generated":{"line":1,"column":515}},{"source":"node_modules/node-forge/lib/kem.js","name":"ceil","original":{"line":57,"column":26},"generated":{"line":1,"column":520}},{"source":"node_modules/node-forge/lib/kem.js","name":"publicKey","original":{"line":57,"column":31},"generated":{"line":1,"column":525}},{"source":"node_modules/node-forge/lib/kem.js","name":"n","original":{"line":57,"column":41},"generated":{"line":1,"column":527}},{"source":"node_modules/node-forge/lib/kem.js","name":"bitLength","original":{"line":57,"column":43},"generated":{"line":1,"column":529}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":57,"column":57},"generated":{"line":1,"column":541}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":59,"column":4},"generated":{"line":1,"column":544}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":60,"column":6},"generated":{"line":1,"column":547}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":60,"column":10},"generated":{"line":1,"column":549}},{"source":"node_modules/node-forge/lib/kem.js","name":"BigInteger","original":{"line":60,"column":14},"generated":{"line":1,"column":553}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":61,"column":8},"generated":{"line":1,"column":555}},{"source":"node_modules/node-forge/lib/kem.js","name":"util","original":{"line":61,"column":14},"generated":{"line":1,"column":557}},{"source":"node_modules/node-forge/lib/kem.js","name":"bytesToHex","original":{"line":61,"column":19},"generated":{"line":1,"column":562}},{"source":"node_modules/node-forge/lib/kem.js","name":"prng","original":{"line":61,"column":30},"generated":{"line":1,"column":573}},{"source":"node_modules/node-forge/lib/kem.js","name":"getBytesSync","original":{"line":61,"column":35},"generated":{"line":1,"column":575}},{"source":"node_modules/node-forge/lib/kem.js","name":"byteLength","original":{"line":61,"column":48},"generated":{"line":1,"column":588}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":62,"column":8},"generated":{"line":1,"column":592}},{"source":"node_modules/node-forge/lib/kem.js","name":"mod","original":{"line":62,"column":12},"generated":{"line":1,"column":596}},{"source":"node_modules/node-forge/lib/kem.js","name":"publicKey","original":{"line":62,"column":16},"generated":{"line":1,"column":600}},{"source":"node_modules/node-forge/lib/kem.js","name":"n","original":{"line":62,"column":26},"generated":{"line":1,"column":602}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":63,"column":12},"generated":{"line":1,"column":611}},{"source":"node_modules/node-forge/lib/kem.js","name":"compareTo","original":{"line":63,"column":14},"generated":{"line":1,"column":613}},{"source":"node_modules/node-forge/lib/kem.js","name":"BigInteger","original":{"line":63,"column":24},"generated":{"line":1,"column":623}},{"source":"node_modules/node-forge/lib/kem.js","name":"ONE","original":{"line":63,"column":35},"generated":{"line":1,"column":625}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":63,"column":43},"generated":{"line":1,"column":631}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":67,"column":4},"generated":{"line":1,"column":634}},{"source":"node_modules/node-forge/lib/kem.js","name":"zeros","original":{"line":67,"column":8},"generated":{"line":1,"column":638}},{"source":"node_modules/node-forge/lib/kem.js","name":"byteLength","original":{"line":67,"column":16},"generated":{"line":1,"column":640}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":66,"column":4},"generated":{"line":1,"column":643}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":66,"column":8},"generated":{"line":1,"column":645}},{"source":"node_modules/node-forge/lib/kem.js","name":"util","original":{"line":66,"column":14},"generated":{"line":1,"column":647}},{"source":"node_modules/node-forge/lib/kem.js","name":"hexToBytes","original":{"line":66,"column":19},"generated":{"line":1,"column":652}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":66,"column":30},"generated":{"line":1,"column":663}},{"source":"node_modules/node-forge/lib/kem.js","name":"toString","original":{"line":66,"column":32},"generated":{"line":1,"column":665}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":66,"column":41},"generated":{"line":1,"column":674}},{"source":"node_modules/node-forge/lib/kem.js","name":"length","original":{"line":67,"column":31},"generated":{"line":1,"column":680}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":78,"column":4},"generated":{"line":1,"column":687}},{"source":"node_modules/node-forge/lib/kem.js","name":"zeros","original":{"line":68,"column":7},"generated":{"line":1,"column":694}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":68,"column":15},"generated":{"line":1,"column":696}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":69,"column":6},"generated":{"line":1,"column":700}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":69,"column":10},"generated":{"line":1,"column":702}},{"source":"node_modules/node-forge/lib/kem.js","name":"util","original":{"line":69,"column":16},"generated":{"line":1,"column":704}},{"source":"node_modules/node-forge/lib/kem.js","name":"fillString","original":{"line":69,"column":21},"generated":{"line":1,"column":709}},{"source":"node_modules/node-forge/lib/kem.js","name":"String","original":{"line":69,"column":32},"generated":{"line":1,"column":720}},{"source":"node_modules/node-forge/lib/kem.js","name":"fromCharCode","original":{"line":69,"column":39},"generated":{"line":1,"column":727}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":69,"column":52},"generated":{"line":1,"column":740}},{"source":"node_modules/node-forge/lib/kem.js","name":"zeros","original":{"line":69,"column":56},"generated":{"line":1,"column":743}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":69,"column":65},"generated":{"line":1,"column":746}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":78,"column":11},"generated":{"line":1,"column":749}},{"source":"node_modules/node-forge/lib/kem.js","name":"encapsulation","original":{"line":78,"column":12},"generated":{"line":1,"column":750}},{"source":"node_modules/node-forge/lib/kem.js","name":"publicKey","original":{"line":73,"column":24},"generated":{"line":1,"column":764}},{"source":"node_modules/node-forge/lib/kem.js","name":"encrypt","original":{"line":73,"column":34},"generated":{"line":1,"column":766}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":73,"column":42},"generated":{"line":1,"column":774}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":73,"column":45},"generated":{"line":1,"column":776}},{"source":"node_modules/node-forge/lib/kem.js","name":"key","original":{"line":78,"column":42},"generated":{"line":1,"column":784}},{"source":"node_modules/node-forge/lib/kem.js","name":"kdf","original":{"line":76,"column":14},"generated":{"line":1,"column":788}},{"source":"node_modules/node-forge/lib/kem.js","name":"generate","original":{"line":76,"column":18},"generated":{"line":1,"column":790}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":76,"column":27},"generated":{"line":1,"column":799}},{"source":"node_modules/node-forge/lib/kem.js","name":"keyLength","original":{"line":76,"column":30},"generated":{"line":1,"column":801}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":91,"column":2},"generated":{"line":1,"column":806}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":91,"column":16},"generated":{"line":1,"column":814}},{"source":"node_modules/node-forge/lib/kem.js","name":"privateKey","original":{"line":91,"column":25},"generated":{"line":1,"column":823}},{"source":"node_modules/node-forge/lib/kem.js","name":"encapsulation","original":{"line":91,"column":37},"generated":{"line":1,"column":825}},{"source":"node_modules/node-forge/lib/kem.js","name":"keyLength","original":{"line":91,"column":52},"generated":{"line":1,"column":827}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":93,"column":4},"generated":{"line":1,"column":830}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":93,"column":8},"generated":{"line":1,"column":834}},{"source":"node_modules/node-forge/lib/kem.js","name":"privateKey","original":{"line":93,"column":12},"generated":{"line":1,"column":836}},{"source":"node_modules/node-forge/lib/kem.js","name":"decrypt","original":{"line":93,"column":23},"generated":{"line":1,"column":838}},{"source":"node_modules/node-forge/lib/kem.js","name":"encapsulation","original":{"line":93,"column":31},"generated":{"line":1,"column":846}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":93,"column":46},"generated":{"line":1,"column":848}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":94,"column":4},"generated":{"line":1,"column":856}},{"source":"node_modules/node-forge/lib/kem.js","name":"kdf","original":{"line":94,"column":11},"generated":{"line":1,"column":863}},{"source":"node_modules/node-forge/lib/kem.js","name":"generate","original":{"line":94,"column":15},"generated":{"line":1,"column":865}},{"source":"node_modules/node-forge/lib/kem.js","name":"r","original":{"line":94,"column":24},"generated":{"line":1,"column":874}},{"source":"node_modules/node-forge/lib/kem.js","name":"keyLength","original":{"line":94,"column":27},"generated":{"line":1,"column":876}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":97,"column":2},"generated":{"line":1,"column":881}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":97,"column":9},"generated":{"line":1,"column":888}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":111,"column":0},"generated":{"line":1,"column":891}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":111,"column":6},"generated":{"line":1,"column":893}},{"source":"node_modules/node-forge/lib/kem.js","name":"kdf1","original":{"line":111,"column":10},"generated":{"line":1,"column":897}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":111,"column":17},"generated":{"line":1,"column":902}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":111,"column":26},"generated":{"line":1,"column":911}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":111,"column":30},"generated":{"line":1,"column":913}},{"source":"node_modules/node-forge/lib/kem.js","name":"_createKDF","original":{"line":112,"column":2},"generated":{"line":1,"column":916}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":112,"column":13},"generated":{"line":1,"column":918}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":112,"column":19},"generated":{"line":1,"column":923}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":112,"column":23},"generated":{"line":1,"column":925}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":112,"column":26},"generated":{"line":1,"column":927}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":112,"column":42},"generated":{"line":1,"column":930}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":112,"column":45},"generated":{"line":1,"column":932}},{"source":"node_modules/node-forge/lib/kem.js","name":"forge","original":{"line":124,"column":0},"generated":{"line":1,"column":947}},{"source":"node_modules/node-forge/lib/kem.js","name":"kem","original":{"line":124,"column":6},"generated":{"line":1,"column":949}},{"source":"node_modules/node-forge/lib/kem.js","name":"kdf2","original":{"line":124,"column":10},"generated":{"line":1,"column":953}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":124,"column":17},"generated":{"line":1,"column":958}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":124,"column":26},"generated":{"line":1,"column":967}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":124,"column":30},"generated":{"line":1,"column":969}},{"source":"node_modules/node-forge/lib/kem.js","name":"_createKDF","original":{"line":125,"column":2},"generated":{"line":1,"column":972}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":125,"column":13},"generated":{"line":1,"column":974}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":125,"column":19},"generated":{"line":1,"column":979}},{"source":"node_modules/node-forge/lib/kem.js","original":{"line":125,"column":23},"generated":{"line":1,"column":981}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":125,"column":26},"generated":{"line":1,"column":983}},{"source":"node_modules/node-forge/lib/kem.js","name":"md","original":{"line":125,"column":42},"generated":{"line":1,"column":986}},{"source":"node_modules/node-forge/lib/kem.js","name":"digestLength","original":{"line":125,"column":45},"generated":{"line":1,"column":988}}],"sources":{"node_modules/node-forge/lib/kem.js":"/**\n * Javascript implementation of RSA-KEM.\n *\n * @author Lautaro Cozzani Rodriguez\n * @author Dave Longley\n *\n * Copyright (c) 2014 Lautaro Cozzani <lautaro.cozzani@scytl.com>\n * Copyright (c) 2014 Digital Bazaar, Inc.\n */\nvar forge = require('./forge');\nrequire('./util');\nrequire('./random');\nrequire('./jsbn');\n\nmodule.exports = forge.kem = forge.kem || {};\n\nvar BigInteger = forge.jsbn.BigInteger;\n\n/**\n * The API for the RSA Key Encapsulation Mechanism (RSA-KEM) from ISO 18033-2.\n */\nforge.kem.rsa = {};\n\n/**\n * Creates an RSA KEM API object for generating a secret asymmetric key.\n *\n * The symmetric key may be generated via a call to 'encrypt', which will\n * produce a ciphertext to be transmitted to the recipient and a key to be\n * kept secret. The ciphertext is a parameter to be passed to 'decrypt' which\n * will produce the same secret key for the recipient to use to decrypt a\n * message that was encrypted with the secret key.\n *\n * @param kdf the KDF API to use (eg: new forge.kem.kdf1()).\n * @param options the options to use.\n *          [prng] a custom crypto-secure pseudo-random number generator to use,\n *            that must define \"getBytesSync\".\n */\nforge.kem.rsa.create = function(kdf, options) {\n  options = options || {};\n  var prng = options.prng || forge.random;\n\n  var kem = {};\n\n  /**\n   * Generates a secret key and its encapsulation.\n   *\n   * @param publicKey the RSA public key to encrypt with.\n   * @param keyLength the length, in bytes, of the secret key to generate.\n   *\n   * @return an object with:\n   *   encapsulation: the ciphertext for generating the secret key, as a\n   *     binary-encoded string of bytes.\n   *   key: the secret key to use for encrypting a message.\n   */\n  kem.encrypt = function(publicKey, keyLength) {\n    // generate a random r where 1 < r < n\n    var byteLength = Math.ceil(publicKey.n.bitLength() / 8);\n    var r;\n    do {\n      r = new BigInteger(\n        forge.util.bytesToHex(prng.getBytesSync(byteLength)),\n        16).mod(publicKey.n);\n    } while(r.compareTo(BigInteger.ONE) <= 0);\n\n    // prepend r with zeros\n    r = forge.util.hexToBytes(r.toString(16));\n    var zeros = byteLength - r.length;\n    if(zeros > 0) {\n      r = forge.util.fillString(String.fromCharCode(0), zeros) + r;\n    }\n\n    // encrypt the random\n    var encapsulation = publicKey.encrypt(r, 'NONE');\n\n    // generate the secret key\n    var key = kdf.generate(r, keyLength);\n\n    return {encapsulation: encapsulation, key: key};\n  };\n\n  /**\n   * Decrypts an encapsulated secret key.\n   *\n   * @param privateKey the RSA private key to decrypt with.\n   * @param encapsulation the ciphertext for generating the secret key, as\n   *          a binary-encoded string of bytes.\n   * @param keyLength the length, in bytes, of the secret key to generate.\n   *\n   * @return the secret key as a binary-encoded string of bytes.\n   */\n  kem.decrypt = function(privateKey, encapsulation, keyLength) {\n    // decrypt the encapsulation and generate the secret key\n    var r = privateKey.decrypt(encapsulation, 'NONE');\n    return kdf.generate(r, keyLength);\n  };\n\n  return kem;\n};\n\n// TODO: add forge.kem.kdf.create('KDF1', {md: ..., ...}) API?\n\n/**\n * Creates a key derivation API object that implements KDF1 per ISO 18033-2.\n *\n * @param md the hash API to use.\n * @param [digestLength] an optional digest length that must be positive and\n *          less than or equal to md.digestLength.\n *\n * @return a KDF1 API object.\n */\nforge.kem.kdf1 = function(md, digestLength) {\n  _createKDF(this, md, 0, digestLength || md.digestLength);\n};\n\n/**\n * Creates a key derivation API object that implements KDF2 per ISO 18033-2.\n *\n * @param md the hash API to use.\n * @param [digestLength] an optional digest length that must be positive and\n *          less than or equal to md.digestLength.\n *\n * @return a KDF2 API object.\n */\nforge.kem.kdf2 = function(md, digestLength) {\n  _createKDF(this, md, 1, digestLength || md.digestLength);\n};\n\n/**\n * Creates a KDF1 or KDF2 API object.\n *\n * @param md the hash API to use.\n * @param counterStart the starting index for the counter.\n * @param digestLength the digest length to use.\n *\n * @return the KDF API object.\n */\nfunction _createKDF(kdf, md, counterStart, digestLength) {\n  /**\n   * Generate a key of the specified length.\n   *\n   * @param x the binary-encoded byte string to generate a key from.\n   * @param length the number of bytes to generate (the size of the key).\n   *\n   * @return the key as a binary-encoded string.\n   */\n  kdf.generate = function(x, length) {\n    var key = new forge.util.ByteBuffer();\n\n    // run counter from counterStart to ceil(length / Hash.len)\n    var k = Math.ceil(length / digestLength) + counterStart;\n\n    var c = new forge.util.ByteBuffer();\n    for(var i = counterStart; i < k; ++i) {\n      // I2OSP(i, 4): convert counter to an octet string of 4 octets\n      c.putInt32(i);\n\n      // digest 'x' and the counter and add the result to the key\n      md.start();\n      md.update(x + c.getBytes());\n      var hash = md.digest();\n      key.putBytes(hash.getBytes(digestLength));\n    }\n\n    // truncate to the correct key length\n    key.truncate(key.length() - length);\n    return key.getBytes();\n  };\n}\n"},"lineCount":null}},"error":null,"hash":"d57787fc705caee13ae913bddb297215","cacheData":{"env":{}}}